---
title: "Distribuzioni di probabilità discrete (1)"
description: |
  È possibile usare le funzioni contenute in alcuni pacchetti `R` per facilitare la soluzione degli esercizi sulle distribuzioni di probabilità discrete.
author:
  - name: Corrado Caudek
    url: https://caudekblog.netlify.app
date: 03-19-2021
output:
  distill::distill_article:
    self_contained: false
    toc: true
    toc_depth: 2
draft: false
creative_commons: CC BY
categories:
  - Psicometria
  - R
preview: preview.png
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# TL; DR

Utilizzeremo qui le funzioni fornite dal pacchetto `prob` per affrontare alcuni comuni problemi di calcolo delle probabilità nel caso in cui lo spazio campionario è costitutito da un insieme finito di eventi elementari aventi tutti la stessa probabilità di verificarsi.


```{r}
library("prob")
```

# Il lancio di un dado

Consideriamo l'esperimento casuale consistente nel lancio di dado bilanciato e utilizziamo la funzione `rolldie()`: 

```{r}
rolldie(1, makespace = TRUE)
```
La funzione `rolldie()` crea un dataframe in cui ciascuna riga corrisponde ad un punto dello spazio campionario (cioè un evento elementare). La colonna `probs` riporta la probabilità associata a ciascun punto dello spazio campionario.


# Il lancio di due dadi

Ovviamente possiamo essere più ambiziosi e costruire, ad esempio, lo spazio campionario associato all'esperimento casuale che consiste nel lancio di due dadi bilanciati:

```{r}
S <- rolldie(2, makespace = TRUE)
S
```

In questo caso, il dataframe $S$ è costituito da $6 \times 6$ righe:

```{r}
nrow(S)
```

Sullo spazio campionario $S$ definiamo ora gli eventi $A$ e $B$. Siano $A$ e $B$ due eventi in $S$ tali per cui 

- $A$: i due lanci producono lo stesso risultato,
- $B$: la somma dei punti dei due lanci è maggiore o uguale a 8.

Per identificare tali eventi è sufficiente estrarre dal dataframe `S` le righe (eventi elementari) che corrispondono alla definizione dei due eventi:

```{r}
A <- subset(S, X1 == X2)
B <- subset(S, X1 + X2 >= 8)
```

```{r}
A
```

La probabilità del verificarsi dell'evento $A$ è 

```{r}
6 / 36
```

In `R` dobbiamo sommare i valori della colonna `probs` e questo viene fatto dalla funzione `Prob()` che prende come argomento l'oggetto che corrisponde al sottoinsieme di $S$ che abbiamo definito:

```{r}
Prob(A)
```

Facciamo la stessa cosa per $B$:

```{r}
nrow(B)
```

Dunque, la probabilità di $B$ è 

```{r}
15 / 36
```

ovvero

```{r}
Prob(B)
```


# Probabilità condizionata

La probabilità condizionata di $A$ dato $B$ corrisponde alla somma delle probabilità degli eventi elementari in $A$, se consideriamo solo il sottoinsieme $B$. Esaminiamo dunque $B$:

```{r}
B
```

Ci chiediamo quali righe nel dataframe `B` sono tali per cui `X1 == X2`:

```{r}
B[B$X1 == B$X2, ]
```

La soluzione è dunque data dalla somma dei valori `probs` nel dataframe riportato sopra, la quale va divisa per la somma dei valori `probs` contenuti nel dataframe `B`:

```{r}
sum(B[B$X1 == B$X2, ]$probs) / sum(B$probs)
```

Tale risultato può essere ottenuto usando la seguente istruzione: 

```{r}
Prob(A, given = B)
```
È dunque facile trovare, seguendo la stessa procedura, la probabilità $P(B \mid A)$:

```{r}
Prob(B, given = A)
```

# Indipendenza

Chiediamoci ora se $A$ e $B$ sono indipendenti.

Per affrontare questo problema dobbiamo calcolare la probabilità $P(A \cap B)$. Per fare questo dobbiamo selezionare le righe di $S$ nelle quali la colonna `X1` è uguale alla colonna `X2` e poi sommare i valori di probabilità contenuti nella colonna `probs`.  Usiamo la funzione `intersect()`:

```{r}
intersect(A, B)
```

La probabilità dell'intersezione $A \cap B$ è dunque uguale a 

```{r}
3 / 36
```

ovvero:

```{r}
Prob(intersect(A, B))
```

Siamo ora nelle condizioni di decidere se $A$ e $B$ sono o meno indipendenti. Sappiamo che due eventi sono indipendenti se $P(A \cap B) = P(A) P(B)$.  Verifichiamo:

```{r}
Prob(A) * Prob(B)
```

il che non corrisponde al valore `r Prob(intersect(A, B))`. Possiamo dunque concludere che gli eventi $A$ e $B$ non sono indipendenti.
